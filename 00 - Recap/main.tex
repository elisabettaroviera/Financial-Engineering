\documentclass[a4paper,12pt]{article}

% Preambolo
\usepackage[utf8]{inputenc}  % Supporto per caratteri UTF-8
\usepackage[margin=1cm,includefoot]{geometry}  % Margini ridotti (1 cm su tutti i lati)
\usepackage{titlesec}  % Personalizzazione dei titoli
\usepackage{setspace}  % Controllo della spaziatura
%\usepackage{parskip}   % Evita indentazioni, aggiunge spazio tra i paragrafi
\usepackage{enumitem}  % Per personalizzare gli elenchi
\usepackage{amssymb}
\usepackage{fancyhdr}
\usepackage{amsmath,amssymb}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{subcaption}

% Spaziatura paragrafi
\setlength{\parskip}{2pt}
\setlength{\parindent}{0pt}

% Paragrafi compatti
\titlespacing*{\paragraph}{0pt}{4pt}{6pt}

% Liste senza spaziatura extra
\setlist{
  topsep=0pt,
  partopsep=0pt,
  itemsep=0pt,
  parsep=0pt
}




% --- LISTINGS (MATLAB look) ---
\usepackage[T1]{fontenc}
\usepackage[dvipsnames]{xcolor}
\usepackage{listings}

% Colori simili a MATLAB editor
\definecolor{MatlabBlue}{RGB}{0,0,255}
\definecolor{MatlabGreen}{RGB}{0,153,0}
\definecolor{MatlabPurple}{RGB}{153,0,153}
\definecolor{MatlabGray}{RGB}{120,120,120}
\definecolor{SoftGold}{RGB}{184,134,11} % Goldenrod

\lstdefinestyle{matlabStyle}{
  language=Matlab,
  basicstyle=\ttfamily\small,
  keywordstyle=\color{MatlabBlue},
  commentstyle=\color{MatlabGreen},
  stringstyle=\color{MatlabPurple},
  numbers=none,              % come MATLAB: niente numeri
  showstringspaces=false,
  breaklines=true,
  frame=single,              % riquadro
  rulecolor=\color{MatlabGray},
  tabsize=4,
  columns=fullflexible,
  keepspaces=true,
  % --- accenti robusti dentro lstlisting ---
  literate=
    {à}{{\`a}}1 {è}{{\`e}}1 {é}{{\'e}}1 {ì}{{\`i}}1 {ò}{{\`o}}1 {ù}{{\`u}}1
    {À}{{\`A}}1 {È}{{\`E}}1 {É}{{\'E}}1 {Ì}{{\`I}}1 {Ò}{{\`O}}1 {Ù}{{\`U}}1
}




% Operatore "opt" (max o min a seconda del contesto)
\DeclareMathOperator*{\opt}{opt}

\usepackage{graphicx}
\usepackage{tikz}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage[dvipsnames,svgnames]{xcolor}

% ------------------------------
% INDICE: solo section, senza titolo
% ------------------------------
\setcounter{tocdepth}{1}      % mostra solo \section
\renewcommand{\contentsname}{} % rimuove "Contents"

% Personalizzazione del titolo in alto
\makeatletter
\renewcommand{\maketitle}{
    \begin{center}
        \vspace{-2cm}
        {\LARGE \textbf{\@title}} \\[-0.2cm]
    \end{center}
}


% Impostazioni per i numeri di pagina
\pagestyle{empty}


% Dettagli del documento
\title{Financial Engineering}
\date{}
\titlespacing*{\section}{0pt}{-20pt}{4pt}
\definecolor{PastelGreenYellow}{RGB}{230,238,156}
\definecolor{MutedGreenYellow}{RGB}{205,237,176}


\begin{document}

%\maketitle
%\tableofcontents

%\vspace{-5cm}
\textcolor{NavyBlue}{\section{Recap Lezione 1 -- Financial Instruments and Markets}}

\paragraph{Idea generale della lezione}
La lezione introduce i \textbf{financial instruments} e i \textbf{financial markets}, presentando le principali categorie di \textbf{securities e contratti}, con particolare attenzione a \textbf{bonds}, \textbf{stocks}, \textbf{derivatives}, \textbf{forwards}, \textbf{futures} e \textbf{options}.  
L’obiettivo è fornire le definizioni di base, chiarire le differenze tra strumenti e introdurre i concetti di \textbf{payoff}, \textbf{price}, \textbf{risk} e \textbf{posizioni long/short}.

\paragraph{Securities e contratti}
Una \textbf{security} è un documento che conferisce diritti di proprietà su un \textbf{financial claim}.  
I mercati finanziari vengono classificati in base alle caratteristiche degli strumenti dal punto di vista dell’investitore.

\paragraph{Classificazione principale}
\begin{itemize}[label=-]
\item \textbf{Basic securities}
  \begin{itemize}[label=-]
  \item \textbf{Stocks} Securities che rappresentano una quota di proprietà di un’impresa
  \item \textbf{Fixed income (bonds)} Securities di debito che prevedono pagamenti determinati o predeterminabili
  \item \textbf{Foreign exchange (FX)} Strumenti legati allo scambio tra valute diverse
  \item \textbf{Commodities} Beni fisici standardizzati scambiati nei mercati finanziari
  \end{itemize}
\item \textbf{Derivatives and contracts}
  \begin{itemize}[label=-]
  \item \textbf{Forwards e futures} Contratti che fissano oggi le condizioni di uno scambio futuro
  \item \textbf{Options (call e put)} Contratti che conferiscono il diritto, ma non l’obbligo, di comprare o vendere un underlying
  \end{itemize}
\end{itemize}

\paragraph{Bonds}
Un \textbf{bond} è una security che rappresenta uno strumento di debito e conferisce al detentore il diritto a ricevere flussi di cassa futuri determinati.

\begin{itemize}[label=-]
\item Un pagamento predeterminato a una data futura detta \textbf{maturity}
\item Un \textbf{nominal value} detto anche face value, par value o principal
\end{itemize}

Caratteristiche principali
\begin{itemize}[label=-]
\item Il \textbf{bond price} è il prezzo pagato dal creditore al debitore
\item Il \textbf{nominal value} è l’importo rimborsato alla maturity
\item L’\textbf{interest rate} è espresso come percentuale del nominal value
\item I bonds sono soggetti a \textbf{default risk}
\end{itemize}

\paragraph{Tipologie di bonds}
\begin{itemize}[label=-]
\item \textbf{Maturity}
  \begin{itemize}[label=-]
  \item Short-term bond con maturity minore o uguale a un anno
  \item Long-term bond con maturity superiore a un anno
  \end{itemize}
\item \textbf{Pure discount bond / zero coupon bond}
  \begin{itemize}[label=-]
  \item Bond che prevede un unico pagamento alla maturity
  \item Prezzo iniziale inferiore al nominal value
  \end{itemize}
\item \textbf{Coupon bond}
  \begin{itemize}[label=-]
  \item Bond che prevede pagamenti periodici detti \textbf{coupons}
  \item Alla maturity pagamento dell’ultimo coupon più il nominal value
  \end{itemize}
\end{itemize}

\paragraph{Stocks}
Una \textbf{stock} è una security che conferisce al detentore una quota di proprietà dell’impresa emittente.

\begin{itemize}[label=-]
\item I profitti possono essere reinvestiti oppure distribuiti come \textbf{dividends}
\item I dividends non sono garantiti
\item Il prezzo è noto al tempo iniziale ma non nel futuro
\end{itemize}

\paragraph{Risk}
L’acquisto e la successiva vendita di una stock può generare un risultato incerto.

\begin{itemize}[label=-]
\item \textbf{Profit} Quando il return è positivo
\item \textbf{Loss} Quando il return è negativo
\end{itemize}

Il \textbf{return} dipende dalla differenza tra prezzo di vendita e prezzo di acquisto.  
La \textbf{capital gain} è la differenza tra selling price e initial price, mentre il rapporto tra dividend e prezzo è detto \textbf{dividend yield}.

\paragraph{Posizioni}
\begin{itemize}[label=-]
\item \textbf{Long position} Posizione che consiste nell’acquisto di una security
\item \textbf{Short position} Posizione che consiste nella vendita di una security non posseduta
\item Il venditore short beneficia di una riduzione del prezzo
\item Ogni contratto è uno \textbf{zero-sum game}
\end{itemize}

\paragraph{Derivatives}
Un \textbf{derivative} è uno strumento finanziario il cui valore dipende dal valore di un \textbf{underlying asset}.  
I derivatives sono anche detti \textbf{contingent claims} e permettono il trasferimento del rischio tra operatori.

\paragraph{Forwards e Futures}
Un \textbf{forward contract} è un accordo in cui le parti fissano oggi prezzo, quantità e data futura di consegna, con regolamento alla maturity e tipica negoziazione \textbf{OTC}.  
Un \textbf{future contract} è un contratto simile ma scambiato in un \textbf{exchange} ed è soggetto a \textbf{marking to market}.

\paragraph{Spot price, forward price e payoff}
Lo \textbf{spot price} è il prezzo corrente dell’underlying.  
Il \textbf{forward price} è il prezzo fissato oggi per uno scambio futuro.

\begin{itemize}[label=-]
\item Payoff long position pari a $S_T - K$
\item Payoff short position pari a $K - S_T$
\end{itemize}

Il forward contract è uno \textbf{zero-sum game}.

\paragraph{Options}
Una \textbf{option} è una security che conferisce al detentore il diritto, ma non l’obbligo, di comprare o vendere un underlying a un prezzo prefissato.

\paragraph{Tipologie di options}
\begin{itemize}[label=-]
\item \textbf{Call option} Diritto di acquistare l’underlying
\item \textbf{Put option} Diritto di vendere l’underlying
\end{itemize}

\paragraph{Payoff delle options}
\begin{itemize}[label=-]
\item Call long con payoff $(S_T - K)^+$
\item Put long con payoff $(K - S_T)^+$
\end{itemize}

Il prezzo dell’opzione è detto \textbf{option price} ed è pagato dal buyer al writer.

\newpage
\textcolor{RoyalBlue}{\section{Recap Lezione 2 -- Time Value of Money and Bonds}}
\paragraph{Idea generale della lezione}
La lezione formalizza il concetto di \textbf{time value of money} e introduce gli strumenti base del \textbf{money market}, con focus su \textbf{zero-coupon bonds} e \textbf{coupon bonds}.  
L’obiettivo è capire come confrontare valori monetari in tempi diversi tramite \textbf{capitalizzazione} e \textbf{sconto}, come definire correttamente un \textbf{return}, e come prezzare e confrontare investimenti tramite \textbf{discount factors}, \textbf{zero rates}, \textbf{yield} e \textbf{par yield}.

\paragraph{Time value of money}
Si investe oggi un capitale (principal) \(P\) e si vuole determinare il valore futuro \(A(t)\) al tempo \(t\), oppure viceversa si conosce un valore futuro e si vuole trovare il valore equivalente oggi.  
L’interesse maturato è \(I(t)=A(t)-P\). Per unità di tempo \(t=1\), si ha \(A-P=I\).  
Il \textbf{tasso di interesse} è definito come
\[
r=\frac{I}{P}
\qquad\Rightarrow\qquad
I=Pr.
\]

\paragraph{Simple compounding}
L’interesse cresce in modo \textbf{lineare} nel tempo, senza ``interesse sull’interesse''.  
L’ammontare al tempo \(t\) è
\[
A(t)=P+Prt=P(1+rt),
\]
con \textbf{growth factor} \(1+rt\).  
Lo sconto corrispondente è
\[
P=\frac{A(t)}{1+rt}.
\]
La coerenza delle unità di tempo è essenziale, il tasso deve essere espresso nella stessa unità del tempo utilizzato.

\paragraph{Compound compounding}
L’interesse viene \textbf{capitalizzato periodicamente}, quindi ogni periodo l’interesse maturato entra nel capitale e genera ulteriore interesse.  
Con \(r\) \textbf{nominal annual rate} convertibile \(m\) volte l’anno, il tasso per periodo è \(\frac{r}{m}\) e dopo \(t\) anni
\[
A(t)=P\left(1+\frac{r}{m}\right)^{mt}.
\]
Il valore attuale si ottiene con lo sconto
\[
P=\frac{A(t)}{\left(1+\frac{r}{m}\right)^{mt}}.
\]

\paragraph{Nominal annual rate}
Si introduce un tasso annuo \textbf{nominale} \(r\) quando la capitalizzazione avviene \(m\) volte l’anno, in modo che il tasso per periodo sia \(\frac{r}{m}\) e l’accumulazione su \(t\) anni sia coerente con la convenzione di capitalizzazione periodica
\[
A(t)=P\left(1+\frac{r}{m}\right)^{mt}.
\]

\paragraph{Effective annual rate}
Si vogliono confrontare investimenti con diverse frequenze di capitalizzazione tramite un unico tasso annuo ``comparabile''.  
L’\textbf{effective annual rate} \(r_e\) è definito imponendo equivalenza a un anno
\[
P(1+r_e)=P\left(1+\frac{r}{m}\right)^m
\qquad\Rightarrow\qquad
r_e=\left(1+\frac{r}{m}\right)^m-1.
\]

\paragraph{Continuous compounding}
La capitalizzazione avviene in modo ``continuo'' nel tempo.  
Passando al limite \(m\to\infty\)
\[
A(t)=Pe^{rt},
\qquad
P=A(t)e^{-rt}.
\]
La relazione con l’effective annual rate è
\[
Pe^r=P(1+r_e)
\qquad\Rightarrow\qquad
r=\ln(1+r_e),
\quad
r_e=e^r-1.
\]

\paragraph{Equation of value}
Si hanno più flussi di cassa in tempi diversi (prestiti, rimborsi, pagamenti) e si vuole imporre che siano \textbf{equivalenti} rispetto a un tempo di riferimento (tipicamente \(t=0\)).  
Il principio è riportare tutti i flussi allo stesso tempo con i fattori di sconto e imporre l’uguaglianza tra valori attuali. In forma generale
\[
\sum_{i} \text{CF}_i \cdot \text{DF}(t_i)=0,
\]
dove \(\text{DF}(t_i)\) è il discount factor coerente con la convenzione di capitalizzazione adottata.

\paragraph{Return: linear return e log-return}
Si osserva un valore \(V(s)\) al tempo \(s\) e un valore \(V(t)\) al tempo \(t\), e si vuole misurare la performance dell’investimento tra \(s\) e \(t\).  
Il \textbf{linear return} è
\[
LR(s,t)=\frac{V(t)-V(s)}{V(s)}.
\]
Nel caso di interesse semplice, il return è coerente con l’additività su intervalli consecutivi. Con capitalizzazione non lineare (es.\ continua) tale additività non vale in generale.  
Si introduce il \textbf{log-return}
\[
R(s,t)=\ln\!\left(\frac{V(t)}{V(s)}\right),
\]
che soddisfa sempre l’additività
\[
R(t_1,t_2)+R(t_2,t_3)=R(t_1,t_3).
\]

\paragraph{Money market}
Si considerano strumenti \textbf{risk-free} che generano flussi deterministici e che vengono usati come ``mattoni'' per prezzare cash flow futuri.  
Tra gli strumenti si considerano \textbf{zero coupon bonds}, \textbf{coupon bonds}, \textbf{bond forwards}, \textbf{annuities} e \textbf{bank account}.  
Il formalismo chiave è quello dei \textbf{discount factors} e dei \textbf{zero rates}.

\paragraph{Bank account}
Si considera un conto bancario come strumento risk-free che permette di accumulare capitale nel tempo secondo una convenzione di capitalizzazione scelta.  
Indicando con \(A(t)\) l’ammontare al tempo \(t\), le forme tipiche sono \(A(t)=P(1+rt)\), \(A(t)=P\left(1+\frac{r}{m}\right)^{mt}\) oppure \(A(t)=Pe^{rt}\), con attualizzazione ottenuta invertendo la rispettiva relazione.

\paragraph{Annuity}
Si considera un’\textbf{annuity} come una sequenza di pagamenti deterministici a date prefissate.  
Il valore oggi è la somma dei valori attuali dei pagamenti, ottenuti scontando ciascun flusso con il fattore di sconto coerente con la struttura dei tassi.

\paragraph{Investment in bond}
Si interpreta l’acquisto di un bond come un investimento che scambia un esborso certo oggi con una sequenza di flussi futuri deterministici.  
Il confronto tra investimenti in bond passa attraverso attualizzazione dei flussi, uso di zero rates e sintesi tramite yield e par yield.

\paragraph{Zero-coupon bonds (ZCB)}
Si vuole prezzare oggi un titolo che paga \textbf{un solo} flusso certo a scadenza \(T\).  
Indicando con \(B(t,T)\) il valore al tempo \(t<T\)
\[
B(T,T)=1.
\]
Se il bond è scambiato a mercato, lo \textbf{zero rate} implicito (continuamente composto) è definito da
\[
B(0,T)=e^{-r(0,T)T}
\qquad\Rightarrow\qquad
r(0,T)=-\ln\big(\frac{B(0,T)}{T}\big),
\]
e analogamente
\[
B(t,T)=e^{-r(t,T)(T-t)}
\qquad\Rightarrow\qquad
r(t,T)=-\ln\big(\frac{B(t,T)}{T-t}\big).
\]

\paragraph{Coupon bonds}
Si vuole prezzare oggi un titolo che paga cedole a date intermedie e rimborsa il face value alla maturity.  
Il prezzo teorico è il valore attuale di tutti i flussi. Se le cedole \(c_i\) sono pagate ai tempi \(t_i\) e \(t_n=T\), con face value \(F=1\)
\[
C(0,T)=\sum_{i=1}^{n-1} c_i\,e^{-r_i t_i}+(c_n+1)e^{-r_n t_n},
\]
dove \(r_i\) sono i tassi (zero rates) associati alle diverse scadenze.

\paragraph{Bond yield}
Si osserva un prezzo di mercato di un bond e si vuole riassumere l’intera struttura dei flussi con un \textbf{unico} tasso equivalente.  
Lo \textbf{yield} \(y\) è il tasso (unico) che, applicato a tutti i flussi del bond, riproduce il prezzo
\[
P=\sum_{i=1}^{n} \text{CF}_i\,e^{-y t_i},
\]
dove \(\text{CF}_i\) sono i flussi di cassa (cedole e rimborso) ai tempi \(t_i\).

\paragraph{Par yield}
Si vuole determinare quale tasso cedolare rende un bond scambiato ``alla pari'', cioè con prezzo uguale al face value.  
Il \textbf{par yield} è il coupon rate \(c\) tale che il prezzo del bond soddisfi
\[
P=F,
\]
con \(P\) dato dalla somma dei valori attuali dei flussi (cedole costruite con \(c\) e rimborso del face value) scontati tramite la struttura dei tassi.

\newpage
\textcolor{CadetBlue}{\section{Recap Lezione 3 -- Duration and Interest Rate Risk}}

\paragraph{Idea generale della lezione}
La lezione analizza il \textbf{rischio di tasso di interesse} associato ai bond e introduce strumenti analitici per misurare la \textbf{sensibilità del prezzo di un titolo obbligazionario alle variazioni del rendimento}.  
Il concetto centrale è la \textbf{duration}, ottenuta a partire da un’approssimazione di primo ordine del prezzo del bond, e il suo utilizzo nella gestione del rischio e nella costruzione di strategie di copertura.

\paragraph{Bond price come funzione del rendimento}
Il prezzo di un bond può essere visto come una funzione del rendimento \(y\),
\[
B(y)=\sum_{i=1}^{n} c_i e^{-y t_i},
\]
dove \(c_i\) sono i flussi di cassa pagati ai tempi \(t_i\).

\paragraph{Sviluppo di Taylor del prezzo del bond}
Si considera lo sviluppo di Taylor del prezzo del bond attorno a un valore \(y_0\),
\[
B(y)=B(y_0)-D(y_0)B(y_0)\Delta y+\frac{1}{2}C(y_0)B(y_0)(\Delta y)^2+\dots
\]
dove \(D(y_0)\) e \(C(y_0)\) rappresentano rispettivamente duration e convexity valutate in \(y_0\).

\paragraph{Duration}
La \textbf{duration} è definita come
\[
D(y) = -\frac{1}{B(y)}\frac{ dB(y)}{ dy}
   = \sum_{i=1}^{n} t_i \bigg(\frac{c_i e^{-y t_i}}{B(y)}\bigg).
\]
La duration ammette le seguenti interpretazioni
\begin{itemize}[label=-]
\item È una \textbf{combinazione convessa dei tempi di pagamento}, poiché i pesi \(\frac{c_i e^{-y t_i}}{B(y)}\) sono positivi e sommano a uno
\item Misura la \textbf{sensitività del prezzo del bond} rispetto a variazioni del rendimento secondo
\[
\frac{\Delta B}{B}\approx -D(y)\,\Delta y
\]
\item Costituisce una \textbf{misura di rischio di tasso di interesse}, quantificando l’esposizione del valore del bond a shock sui tassi
\end{itemize}

\paragraph{Convexity}
La \textbf{convexity} è definita come
\[
C(y) = \frac{1}{B(y)}\frac{d^2 B(y)}{dy^2}
  = \sum_{i=1}^{n} t_i^2 \bigg(\frac{c_i e^{-y t_i}}{B(y)}\bigg).
\]

\paragraph{Portfolio of bonds}
Si considera un portafoglio di \(n\) bond con quantità \(q_i\) e prezzi \(B_i(y)\), per cui il valore del portafoglio è
\[
P(y)=\sum_{i=1}^{n} q_i B_i(y).
\]
Imponendo che la duration del portafoglio soddisfi
\[
-D_p(y)P(y)=\frac{dP(y)}{dy}=-\sum_{i=1}^{n} q_i D_i(y)B_i(y), \qquad
D_p(y)=\frac{\sum_{i=1}^{n} q_i D_i(y)B_i(y)}{P(y)}
      =\sum_{i=1}^{n} D_i(y)\bigg(\frac{q_i B_i(y)}{P(y)}\bigg).
\]
Si definiscono quindi
\[
w_i=\frac{q_i B_i(y)}{P(y)}, \qquad
D_p(y)=\sum_{i=1}^{n} w_i D_i(y).
\]

\paragraph{Dynamic hedging}
La duration fornisce una copertura valida localmente.  
Poiché il rendimento e il tempo influenzano il valore della duration, è necessario un aggiornamento continuo del portafoglio.  
Il \textbf{dynamic hedging} consiste nel ribilanciare dinamicamente le posizioni per mantenere sotto controllo l’esposizione al rischio di tasso.

\newpage
\textcolor{TealBlue}{\section{Recap Lezione 4 -- Term Structure, Bootstrap and Forward Rates}}

\paragraph{Idea generale della lezione}
La lezione studia la \textbf{struttura a termine dei tassi di interesse} senza imporre l’ipotesi che il rendimento sia indipendente dalla maturity.  
Si introducono gli \textbf{spot rates}, la costruzione della \textbf{zero curve tramite bootstrap}, le proprietà di non arbitraggio nel caso di struttura a termine deterministica e il concetto di \textbf{forward rate}, con applicazione ai \textbf{Forward Rate Agreements (FRA)}.

\paragraph{Struttura a termine e prezzo dei bond}
Si considera il prezzo di un zero-coupon bond al tempo \(t\) con maturity \(T\), indicato come \(B(t,T)\), dove \(T-t\) è il \textbf{time-to-maturity}.  
Senza assumere rendimenti costanti sulle maturity, il prezzo del bond è espresso come
\[
B(t,T)=e^{-y(t,T)(T-t)}.
\]

\paragraph{General term structure of zero-coupon bonds}
La struttura a termine dei zero-coupon bond è descritta dall’insieme dei prezzi \(B(t,T)\) al variare della maturity \(T\).  
Essa è equivalente alla struttura a termine dei rendimenti \(y(t,T)\), che sintetizzano l’informazione contenuta nei prezzi dei bond per ogni scadenza.

\paragraph{Spot rate}
Fissando \(t=0\), il rendimento \(y(0,T)\) associato al bond \(B(0,T)\) è detto \textbf{spot rate}.  
Gli spot rates descrivono la struttura a termine iniziale dei tassi di interesse.

\paragraph{Prezzo di un coupon bond tramite spot rates}
Se \(y(0,T)\) dipende solo dalla maturity \(T\), il prezzo di un coupon bond può essere scritto come somma dei valori attuali dei flussi di cassa
\[
P = c_1 e^{-y(0,t_1)t_1} + c_2 e^{-y(0,t_2)t_2} + \dots + (c_n+F)e^{-y(0,T)T}.
\]

\paragraph{Bootstrap method}
Definendo la funzione \(y(0,T)\) come \textbf{zero curve}, il \textbf{bootstrap method} viene utilizzato per costruirla a partire dai prezzi di mercato dei bond.  
Si procede in modo sequenziale
\begin{itemize}[label=-]
\item Si ricavano gli spot rates associati ai zero-coupon bond
\item Si utilizzano tali spot rates per scontare i flussi noti dei bond coupon
\item Si determina iterativamente il nuovo spot rate
\end{itemize}
Nel caso di coupon pagati semestralmente, ciascun flusso viene scontato con il tasso corrispondente alla sua maturity.

\paragraph{Term structure deterministica}
Se la struttura a termine \(y(t,T)\) è deterministica, l’assenza di arbitraggio implica la relazione
\[
B(0,T)=B(0,t)\,B(t,T).
\]

\paragraph{Argomento di non arbitraggio}
La relazione viene dimostrata tramite la costruzione di un portafoglio che soddisfa le seguenti proprietà
\begin{itemize}[label=-]
\item Ha valore nullo a \(t=0\)
\item Ha valore nullo a \(t\)
\item Genera un payoff positivo certo a \(T\)
\end{itemize}
In violazione dell’assenza di arbitraggio se l’uguaglianza non fosse soddisfatta.

\paragraph{Conseguenze}
Se i tassi sono deterministici, la struttura a termine futura \(B(t,T)\) è completamente determinata dalla struttura iniziale.  
Vale inoltre la relazione
\[
B(t,T)=\frac{B(0,T)}{B(0,t)}=e^{y(0,t)t-y(0,T)T}.
\]
In generale, tuttavia, la struttura a termine futura non dipende interamente da quella iniziale.

\paragraph{Forward rates deterministici}
Assumendo che
\[
B(0,T)=B(0,t)\,B(t,T),
\]
i forward rates \(y(t,T)\) risultano deterministici e dipendono solo dalla struttura iniziale.  
Si sottolinea esplicitamente che questa è un’assunzione utile, ma non necessariamente realistica.

\paragraph{Calcolo dei forward rates}
Assumendo continuous compounding, dalla relazione
\[
e^{-y(0,T)T}=e^{-y(0,t)t}\,e^{-y(t,T)(T-t)}, \qquad
y(t,T)=\frac{y(0,T)T-y(0,t)t}{T-t}.
\]
Conoscendo gli spot rates iniziali è quindi possibile determinare tutti i forward rates.

\paragraph{Forward Rate Agreement (FRA)}
Un \textbf{Forward Rate Agreement (FRA)} è un contratto derivato in cui le parti si scambiano, alla maturity del contratto, la differenza tra due tassi di interesse
\begin{itemize}[label=-]
\item Un tasso fisso detto forward rate
\item Un tasso variabile di mercato detto settlement rate
\end{itemize}
La differenza è moltiplicata per la durata del contratto e per il notional principal.

\paragraph{Interpretazione economica del FRA}
Le posizioni contrattuali nel FRA sono così definite
\begin{itemize}[label=-]
\item Il seller dell’FRA riceve il tasso fisso e paga il tasso variabile
\item Il buyer dell’FRA riceve il tasso variabile e paga il tasso fisso
\end{itemize}
Il FRA consente di coprirsi contro variazioni future dei tassi di interesse e permette di fissare oggi il rendimento di un investimento o di un prestito futuro.

\paragraph{Determinazione anticipata dei forward rates}
Attraverso gli spot rates osservabili \(y(0,1)\) e \(y(0,2)\), è possibile costruire un’operazione equivalente tramite zero-coupon bond e determinare il forward rate \(y(1,2)\).  
Il forward rate rappresenta il tasso implicito che rende equivalente il valore attuale dei flussi futuri.

\paragraph{Caratteristiche del FRA}
Il FRA è un contratto con le seguenti caratteristiche
\begin{itemize}[label=-]
\item Non standardizzato
\item Negoziato over-the-counter (OTC)
\item Utilizzabile per hedging, speculazione e arbitraggio
\end{itemize}

\newpage
\textcolor{MediumSeaGreen}{\section{Recap Lezione 5 -- Forward and Futures Contracts}}

\paragraph{Idea generale della lezione}
La lezione introduce in modo formale i \textbf{forward contracts} e i \textbf{futures contracts}, analizzandone \textbf{payoff}, \textbf{pricing per assenza di arbitraggio}, \textbf{valore nel tempo} e differenze strutturali.  
L’attenzione è posta sulla costruzione di strategie di arbitraggio e di \textbf{replicating portfolios}, sul ruolo dei \textbf{dividends}, del \textbf{dividend yield}, dei \textbf{storage costs} e sul funzionamento dei mercati futures con \textbf{marking to market} e \textbf{margin system}.

\paragraph{Forward contract}
Un \textbf{forward contract} è un accordo tra due parti per acquistare o vendere un asset a una data futura \(T\), detta \textbf{delivery time}, a un prezzo fissato oggi, detto \textbf{forward price}.  
Alla stipula non avviene alcun pagamento iniziale.

\paragraph{Forward price}
Il \textbf{forward price} \(F(0,T)\) è il prezzo che rende nullo il valore del forward contract al tempo iniziale.  
Esso è determinato in modo univoco dall’assenza di arbitraggio e dipende dal prezzo spot dell’asset, dal tasso di interesse e da eventuali flussi intermedi.

\paragraph{Long e short forward position}
\begin{itemize}[label=-]
\item \textbf{Long forward position} Obbligo di acquistare l’asset a \(T\) al prezzo \(F(0,T)\)
\item \textbf{Short forward position} Obbligo di vendere l’asset a \(T\) al prezzo \(F(0,T)\)
\end{itemize}

\paragraph{Payoff del forward}
Alla data di consegna \(T\) il payoff è
\[
\text{Long}: S(T)-F(0,T),
\qquad
\text{Short}: F(0,T)-S(T).
\]
Il forward è uno \textbf{zero-sum game}.

\paragraph{Teorema: Pricing del forward su stock senza dividendi}
Si assume un tasso risk-free costante \(r\) con continuous compounding.  
Il forward price su uno stock che non paga dividendi è
\[
F(0,T)=S(0)e^{rT}.
\]
La relazione deriva dall’assenza di arbitraggio e dalla possibilità di replicare il payoff del forward tramite una strategia di trading dinamicamente coerente.

\paragraph{Argomento di non arbitraggio}
Se \(F(0,T)>S(0)e^{rT}\) oppure \(F(0,T)<S(0)e^{rT}\), è possibile costruire una strategia con valore nullo a \(t=0\) e payoff positivo certo a \(T\), generando arbitraggio.  
L’assenza di arbitraggio impone l’uguaglianza.

\paragraph{Teorema: Pricing del forward su stock con dividendi discreti}
Se lo stock paga un dividendo discreto \(d_t\) a una data intermedia \(t\) con \(0<t<T\), il forward price è
\[
F(0,T)=\bigl(S(0)-e^{-rt}d_t\bigr)e^{rT}.
\]
La dimostrazione utilizza un portafoglio che replica il payoff del forward includendo l’incasso dei dividendi intermedi.

\paragraph{Dividend yield continuo}
In molti contesti i dividendi sono modellati come pagati continuamente a un tasso costante \(\delta\), detto \textbf{dividend yield}.  
Una unità di stock detenuta da \(0\) a \(T\) genera un flusso continuo proporzionale al prezzo dell’asset.

\paragraph{Forward su asset con dividend yield}
Per uno stock che paga dividendi continuamente a tasso \(\delta\), il forward price è
\[
F(0,T)=S(0)e^{(r-\delta)T}.
\]

\paragraph{Valore di un forward contract}
Alla stipula il valore del forward è nullo.  
Nel tempo, il valore può diventare positivo o negativo in funzione dell’evoluzione del forward price.

\paragraph{Valore del forward a una data intermedia}
Per \(0\le t\le T\), il valore al tempo \(t\) di un long forward stipulato a \(t=0\) è
\[
V(t)=\bigl[F(t,T)-F(0,T)\bigr]e^{-r(T-t)}.
\]

\paragraph{Caso specifico senza dividendi}
Se l’asset non paga dividendi
\[
V(t)=S(t)-S(0)e^{rt}.
\]

\paragraph{Futures contracts}
Un \textbf{futures contract} è simile a un forward ma è scambiato su un exchange ed è standardizzato.  
Il rischio di default è eliminato tramite il sistema di \textbf{marking to market} e di margini.

\paragraph{Marking to market}
\begin{itemize}[label=-]
\item Regolazione quotidiana di profitti e perdite
\item Valore nullo della posizione futures a ogni istante
\end{itemize}

\paragraph{Margin system}
\begin{itemize}[label=-]
\item \textbf{Initial margin} Deposito iniziale a garanzia
\item \textbf{Maintenance margin} Livello minimo del deposito
\item \textbf{Margin call} Richiesta di reintegro del margine
\end{itemize}
Il clearing house chiude la posizione se la margin call non viene soddisfatta, eliminando il rischio di default.

\paragraph{Liquidità nei futures markets}
Un’importante caratteristica dei futures markets è l’elevata \textbf{liquidity}, dovuta a
\begin{itemize}[label=-]
\item Standardizzazione dei contratti che rende gli strumenti omogenei e facilmente scambiabili
\item Presenza del clearing house che garantisce l’adempimento delle obbligazioni
\end{itemize}

\paragraph{Pricing dei futures}
Se il tasso di interesse è costante
\[
f(0,T)=F(0,T),
\qquad
f(t,T)=S(t)e^{r(T-t)}.
\]
Se i tassi sono deterministici ma variabili nel tempo, la relazione rimane valida con opportune modifiche.

\paragraph{Portfolio}
Un \textbf{portfolio} è un vettore \(h=(x,y)\) che rappresenta le quantità detenute di due asset.  
Il valore del portafoglio è
\[
V_h(t)=xV_X(t)+yV_Y(t).
\]

\paragraph{Replicating portfolio}
Un portafoglio è detto \textbf{replicating portfolio} se riproduce esattamente il payoff di un derivato a scadenza.

\paragraph{Portafoglio replicante di un forward}
Un possibile portafoglio replicante per un long forward è
\[
h=\bigl(-F(0,T)e^{-rT},\,1\bigr).
\]
Il valore del portafoglio è
\[
V_h(0)=-F(0,T)e^{-rT}+S(0),
\qquad
V_h(T)=S(T)-F(0,T).
\]

\paragraph{Principio di no-arbitrage pricing}
Se un claim è replicabile tramite un portafoglio, allora il suo prezzo iniziale deve coincidere con il valore iniziale del portafoglio.  
Per un forward
\[
V_f(0)=0.
\]

\paragraph{Consumption assets}
Un \textbf{consumption asset} è un bene fisico che deve essere stoccato.  
I forward e futures su tali asset sono rilevanti per imprese industriali.

\paragraph{Investment asset}
Se l’asset è un investment asset e non genera costi o benefici intermedi
\[
F(0,T)=S(0)e^{rT}.
\]

\paragraph{Storage costs}
I consumption assets comportano costi di stoccaggio che possono essere interpretati come flussi negativi durante la vita del contratto.  
Indicando con \(U\) il valore attuale dei storage costs.

\paragraph{Consumption asset}
Se l’asset è un consumption asset
\[
F(0,T)=(S(0)+U)e^{rT}.
\]
La formula è ottenuta tramite argomenti di arbitraggio analoghi al caso senza costi.

\newpage
\textcolor{PineGreen}{\section{Recap Lezione 6 -- Hedging with Futures}}

\paragraph{Idea generale della lezione}
Si studia come coprire (hedging) un’esposizione al rischio di prezzo di un asset \(S(t)\) usando forward e soprattutto futures.  
Si evidenzia che il forward può dare copertura perfetta quando l’orizzonte di hedging coincide con la maturity, mentre con i futures in generale compare il \textbf{basis risk}, quindi l’hedging viene impostato come un problema di \textbf{minimizzazione della varianza}.

\paragraph{Scenario e motivazione}
Un modo semplice per coprire l’esposizione alle variazioni di \(S(t)\) è entrare in un forward, ma un forward può non essere facilmente disponibile e presenta rischio di controparte.  
Il mercato futures è invece più sviluppato e liquido e, tramite exchange e clearing house, riduce il rischio di default.

\paragraph{Notazione}
Si indica con \(F(0,T)\) il forward price e con \(f(0,T)\) il futures price.  
Il valore di un forward stipulato a \(0\) e osservato a \(t\) è
\[
V_F(t)=\big(F(t,T)-F(0,T)\big)e^{-r(T-t)}.
\]
In modo analogo, il valore del futures (nella formulazione vista a lezione) si scrive
\[
V_f(t)=\big(f(t,T)-f(0,T)\big)e^{-r(T-t)},
\]
e spesso si usa l’ipotesi operativa \(r=0\), per cui \(e^{rt}=1\).

\paragraph{Hedging con forward e copertura perfetta}
Si considera un portafoglio \(P=(1,N)\) composto da 1 unità dell’asset e \(N\) forward con maturity \(T\), con \(N>0\) long forward e \(N<0\) short forward.  
Il valore del portafoglio è \(V_p(t)=V_S(t)+N V_F(t)\). Poiché \(V_p(0)=S(0)\), alla maturity si ha
\[
V_p(T)=S(T)+N\big(S(T)-F(0,T)\big).
\]
Nel caso \(N=-1\) si ottiene
\[
\Delta V_p(T)=F(0,T)-S(0)e^{rT},
\]
che diventa costante e pari a zero se vale \(F(0,T)=S(0)e^{rT}\). In tale situazione si ottiene \textbf{perfect hedging} e la varianza della variazione di valore è nulla.

\paragraph{Hedging con futures e basis risk}
Si introduce un \textbf{hedge horizon} \(t_h<T\), scelto tipicamente vicino a \(T\).  
Si definisce la \textbf{basis} come \(b(t,T)=S(t)-f(t,T)\). Si ha \(b(T,T)=0\) e \(f(t,T)\to f(T,T)=S(T)\), ma per \(t<t_h<T\) la basis è in generale diversa da zero e può variare nel tempo, generando \textbf{basis risk}.

Si costruisce un portafoglio \(P=(1,N)\) con 1 unità dell’asset e \(N\) futures. Con l’ipotesi operativa \(r=0\), si usa \(V_p(0)=S(0)\) e
\[
V_p(t_h)=S(t_h)+N\big(f(t_h,T)-f(0,T)\big),
\]
quindi
\[
\Delta V_p(t_h)=\big(S(t_h)-S(0)\big)+N\big(f(t_h,T)-f(0,T)\big).
\]
Ponendo \(\Delta S(t_h)=S(t_h)-S(0)\) e \(\Delta f(t_h)=f(t_h,T)-f(0,T)\), si ottiene
\[
\Delta V_p(t_h)=\Delta S(t_h)+N\Delta f(t_h).
\]

\paragraph{Obiettivo e funzione varianza}
Si sceglie \(N\) per minimizzare la varianza della variazione di valore del portafoglio,
\[
\operatorname{Var}\big(\Delta V_p(t_h)\big).
\]
Usando la formula della varianza della somma di due variabili aleatorie,
\[
\operatorname{Var}\big(\Delta V_p(t_h)\big)
=\operatorname{Var}\big(\Delta S(t_h)\big)
+N^2\operatorname{Var}\big(\Delta f(t_h)\big)
+2N\operatorname{Cov}\big(\Delta S(t_h),\Delta f(t_h)\big).
\]
La funzione è convessa in \(N\), quindi il minimo si ottiene imponendo la derivata nulla.

\paragraph{Hedge ratio ottimo}
Derivando rispetto a \(N\) e imponendo lo zero,
\[
\frac{d}{dN}\operatorname{Var}\big(\Delta V_p(t_h)\big)
=2N\operatorname{Var}\big(\Delta f(t_h)\big)
+2\operatorname{Cov}\big(\Delta S(t_h),\Delta f(t_h)\big)=0,
\]
da cui
\[
N^*=-\frac{\operatorname{Cov}\big(\Delta S(t_h),\Delta f(t_h)\big)}
{\operatorname{Var}\big(\Delta f(t_h)\big)}.
\]

\paragraph{Interpretazione economica di \(N^*\)}
La quantità \(N^*\) rappresenta il \textbf{numero ottimo di contratti futures} da includere nel portafoglio per ridurre al minimo la variabilità complessiva della variazione di valore sull’orizzonte \((0,t_h)\).  
Il termine al numeratore misura quanto le variazioni del futures si muovono insieme a quelle dell’asset, mentre il denominatore misura la volatilità del futures stesso.  
Se la covarianza è elevata in valore assoluto, il futures è efficace nel compensare le fluttuazioni dell’asset; se invece la varianza del futures è grande, ne servono meno contratti in valore assoluto per ottenere lo stesso effetto di copertura.

Se \(\operatorname{Cov}(\Delta S,\Delta f)>0\), allora \(N^*<0\) e si assume una posizione \textbf{short} nei futures, poiché le variazioni positive dell’asset tendono a essere compensate da variazioni negative della componente futures del portafoglio.

Scrivendo \(\operatorname{Cov}(\Delta S,\Delta f)=\rho\,\sigma_S\sigma_f\), si ottiene anche
\[
N^*=-\rho\,\frac{\sigma_S}{\sigma_f},
\]
che evidenzia come l’hedge ratio dipenda dalla \textbf{correlazione} tra asset e futures e dal rapporto tra le loro deviazioni standard.

\paragraph{Collegamento con regressione lineare}
La forma di \(N^*\) richiama la regressione lineare
\[
\Delta S=\alpha+\beta \Delta f+\varepsilon,
\]
in cui
\[
\beta=\frac{\operatorname{Cov}(\Delta S,\Delta f)}{\operatorname{Var}(\Delta f)},
\]
quindi \(\beta=-N^*\).  
Il coefficiente di regressione identifica la quantità di futures che minimizza la varianza della variazione di valore del portafoglio sull’intervallo \((0,t_h)\).

\paragraph{Casi notevoli e unitary hedge}
Se \(N^*=0\), allora \(\beta=0\) e non si riesce a fare hedging in modo efficace.  
Se \(N^*=1\), allora \(\beta=-1\) e si ha \textbf{unitary hedge}.  
Il \textbf{perfect hedge} è un caso particolare di unitary hedge quando \(t_h=T\) e l’underlying del derivato coincide con l’asset, condizione che elimina il basis risk.

\paragraph{Effectiveness of the hedge}
Si definisce l’\textbf{effectiveness} come la riduzione relativa della varianza passando dall’asset non coperto al portafoglio coperto,
\[
\frac{\sigma_S^2-\sigma_V^2}{\sigma_S^2}.
\]
Usando il valore ottimo \(N^*\), si ottiene che tale quantità coincide con \(\rho^2\) e anche con \(\beta^2\).  
L’efficacia dell’hedge dipende quindi dalla correlazione lineare tra \(\Delta S\) e \(\Delta f\): maggiore è \(|\rho|\), maggiore è la quota di rischio eliminabile, mentre \(|\rho|<1\) implica varianza residua e quindi presenza di basis risk.

\newpage
\textcolor{MutedGreenYellow}{\section{Recap Lezione 7 -- Options, Payoff, Parity and Bounds}}

\paragraph{Idea generale della lezione}
La lezione introduce le \textbf{opzioni su azioni}, analizzandone payoff e profitto per le diverse posizioni, e sviluppa i principali risultati di \textbf{non arbitraggio}, in particolare la \textbf{put--call parity}, i \textbf{price bounds} per opzioni europee e americane e il teorema di equivalenza tra call americana ed europea in assenza di dividendi.

\paragraph{Tipologie di opzioni}
Si considerano opzioni su azioni, distinguendo
\begin{itemize}[label=-]
\item \textbf{Call option}: diritto di acquistare l’asset sottostante
\item \textbf{Put option}: diritto di vendere l’asset sottostante
\end{itemize}

\paragraph{European e American options}
\begin{itemize}[label=-]
\item \textbf{European options}: esercitabili solo a maturity \(T\)
\item \textbf{American options}: esercitabili in qualunque istante \(t \in [0,T]\)
\end{itemize}

\paragraph{Assunzioni e notazione}
Si assume inizialmente \(r=0\).  
La notazione utilizzata è
\begin{itemize}[label=-]
\item \(K\) strike price
\item \(S(T)\) prezzo dell’asset a maturity
\item \((x)^+ = \max\{x,0\}\)
\end{itemize}

\paragraph{Posizioni long e short}
Per ciascuna opzione si distinguono due posizioni
\begin{itemize}[label=-]
\item \textbf{Long}: acquisto (buy) del diritto
\item \textbf{Short}: vendita (sell) del diritto
\end{itemize}
Vale sempre la relazione \(\text{short} = -\,\text{long}\).

\paragraph{Long call}
Il payoff di una long call è
\[
(S(T)-K)^+
\]
Il profit è
\[
(S(T)-K)^+ - C
\]
dove \(C\) è il call price.  
Si ha perdita limitata pari a \(C\) e profitto potenzialmente illimitato.  
Il break-even è \(S(T)=K+C\).

\paragraph{Short call}
Il payoff è
\[
-(S(T)-K)^+
\]
Il profit è
\[
C-(S(T)-K)^+
\]
Il guadagno massimo è limitato a \(C\), mentre la perdita è illimitata per \(S(T)\to +\infty\).

\paragraph{Long put}
Il payoff di una long put è
\[
(K-S(T))^+
\]
Il profit è
\[
(K-S(T))^+ - P
\]
dove \(P\) è il put price.  
Il break-even è \(S(T)=K-P\).

\paragraph{Short put}
Il payoff è
\[
-(K-S(T))^+
\]
Il profit è
\[
P-(K-S(T))^+
\]
Il guadagno massimo è \(P\), mentre la perdita cresce al diminuire di \(S(T)\).

\paragraph{Terminologia}
Si introducono le seguenti definizioni
\begin{itemize}[label=-]
\item \textbf{Intrinsic value}: valore dell’opzione se fosse esercitata immediatamente
\item \textbf{Time value}: differenza tra market value e intrinsic value
\end{itemize}
Inoltre
\begin{itemize}[label=-]
\item \textbf{At the money}: cashflow nullo
\item \textbf{In the money}: cashflow positivo
\item \textbf{Out of the money}: cashflow negativo
\end{itemize}

\paragraph{Put--call parity per European options}
Per opzioni europee su asset che non paga dividendi vale
\[
C - P = S(0) - K e^{-rT}
\]
La relazione è ottenuta confrontando il payoff di un portafoglio long call e short put con quello di una long forward position.

\paragraph{Put--call parity con dividendi}
Se l’asset paga dividendi con valore attuale \(\text{div}(0)\), la parità diventa
\[
C - P = S(0) - \text{div}(0) - K e^{-rT}
\]

\paragraph{Bounds per European call}
Il prezzo di una European call soddisfa
\[
S(0) - K e^{-rT} \le C \le S(0)
\]
I bounds derivano da argomenti di non arbitraggio.

\paragraph{Bounds per European put}
Il prezzo di una European put soddisfa
\[
- S(0) + K e^{-rT} \le P \le K e^{-rT}
\]

\paragraph{Bounds e parità per American options}
Per opzioni americane su asset senza dividendi vale
\[
S(0) - K e^{-rT} \ge C^A - P^A \ge S(0) - K
\]
Con dividendi
\[
S(0) - K e^{-rT} \ge C^A - P^A \ge S(0) - \text{div}(0) - K
\]

\paragraph{Relazione tra European e American prices}
Le opzioni europee sono un caso particolare di quelle americane, quindi
\[
C \le C^A, \qquad P \le P^A
\]

\paragraph{No-dividend American call theorem}
Se l’asset non paga dividendi, il prezzo della call americana coincide con quello della call europea
\[
C^A = C^E
\]
Ne segue che non è mai ottimale esercitare anticipatamente una American call in assenza di dividendi.

\newpage
\textcolor{SoftGold}{\section{Recap Lezione 8 -- One-Period Binomial Model, Arbitrage and Risk-Neutral Valuation}}

\paragraph{Idea generale della lezione}
La lezione introduce il \textbf{modello binomiale a un periodo} come primo modello discreto per la valutazione di asset rischiosi e derivati finanziari.  
Vengono formalizzati i concetti di \textbf{arbitrage} e \textbf{assenza di arbitrage} e si mostra come, in tale contesto, emergano in modo naturale la \textbf{misura risk-neutral}, i \textbf{contingent claims}, i \textbf{replicating portfolios} e la \textbf{completezza del mercato}.  
Nel modello binomiale privo di arbitraggio, ogni derivato ammette un \textbf{prezzo unico}.

\paragraph{Asset e dinamica del modello}
Si considera un mercato con due asset
\begin{itemize}[label=-]
\item Un \textbf{bond risk-free} \(B\)
\item Uno \textbf{stock rischioso} \(S\)
\end{itemize}

La dinamica è a un solo periodo \(t=0,1\)
\[
B(0)=1, \qquad B(1)=1+r
\]
\[
S(0)=S, \qquad 
S(1)=
\begin{cases}
Su & \text{se } p_u\\
Sd & \text{se } p_d=1-p_u
\end{cases}
\]
È spesso conveniente riscrivere la dinamica dello stock introducendo una variabile aleatoria \(Z\)
\[
S(0)=S,
\qquad
S(1)=S\cdot Z
\]

dove \(Z\) è una \textbf{variabile aleatoria} tale che
\[
Z =
\begin{cases}
u & \text{con probabilità } p_u,\\
d & \text{con probabilità } p_d,
\end{cases}
\qquad
p_u+p_d=1.
\]

I parametri \(u\) e \(d\) sono detti rispettivamente \textbf{up factor} e \textbf{down factor} e si assume
\(
u>1,
\;
d<1.
\)
La variabile aleatoria \(Z\) rappresenta quindi il \textbf{fattore moltiplicativo} che governa l’evoluzione dello stock tra \(t=0\) e \(t=1\).


\paragraph{Portafoglio e value process}
Un portafoglio fisso è descritto da \(h=(x,y)\), dove
\begin{itemize}[label=-]
\item \(x\) rappresenta la quantità investita nel bond
\item \(y\) rappresenta la quantità investita nello stock
\end{itemize}

Il \textbf{value process} del portafoglio è
\[
V^h(t)=xB(t)+yS(t), \qquad t=0,1
\]
e in particolare
\[
V^h(0)=x+yS, \qquad 
V^h(1)=x(1+r)+ySZ
\]

\paragraph{Arbitrage}
Un portafoglio \(h\) è detto un \textbf{arbitrage} se
\[
V^h(0)=0
\]
\[
V^h(1)>0 \quad \text{con probabilità } 1
\]

\paragraph{Assenza di arbitrage}
Il modello binomiale è \textbf{arbitrage-free} se e solo se
\[
d < 1+r < u
\]
In tal caso, il fattore risk-free \(1+r\) è una \textbf{combinazione convessa} di \(u\) e \(d\)

\paragraph{Probabilità risk-neutral}
Se vale \(d < 1+r < u\), esistono \textbf{uniche} probabilità \(q_u,q_d>0\) tali che
\[
\begin{cases}
1+r = q_u u + q_d d\\
q_u + q_d = 1
\end{cases}
\]
con
\[
q_u = \frac{(1+r)-d}{u-d},
\qquad
q_d = \frac{u-(1+r)}{u-d}
\]

\paragraph{Misura risk-neutral}
La misura di probabilità \(Q\) definita da
\[
Q(Z=u)=q_u,
\qquad
Q(Z=d)=q_d
\]
è detta \textbf{risk-neutral measure} (o \textbf{martingale measure})

Sotto \(Q\) vale
\[
S=\mathbb{E}^Q\!\left[\frac{S(1)}{1+r}\right]
\]
cioè il \textbf{prezzo scontato dello stock è una martingala}

\paragraph{Risk-neutral valuation formula}
Nel modello binomiale privo di arbitraggio il prezzo dello stock soddisfa
\[
S=\mathbb{E}^Q\!\left[\frac{S(1)}{1+r}\right]
\]
La formula è \textbf{indipendente dalle probabilità oggettive} \(P\). 
Il modello di mercato \((B,S)\) è \textbf{arbitrage-free} se e solo se esiste una \textbf{martingale measure} \(Q\).


\paragraph{Contingent claims}
Un \textbf{contingent claim} è una variabile aleatoria della forma
\[
X=\phi(Z)
\]
equivalentemente
\[
X=\phi(S(1))
\]
e rappresenta il payoff di un contratto al tempo \(t=1\)

\paragraph{Replicating portfolio e raggiungibilità}
Un claim \(X\) è detto \textbf{raggiungibile} se esiste un portafoglio \(h=(x,y)\) tale che
\[
V^h(1)=X \quad \text{con probabilità } 1
\]
In tal caso \(h\) è detto \textbf{replicating portfolio}

\paragraph{Completezza del mercato}
Un mercato è detto \textbf{completo} se ogni contingent claim è raggiungibile  
Nel modello binomiale a un periodo, \textbf{assenza di arbitraggio implica completezza}

\paragraph{Pricing principle}
Se un claim \(X\) è replicabile da un portafoglio \(h\), allora il suo \textbf{unico prezzo privo di arbitraggio} è
\[
\Pi(t,X)=V^h(t), \qquad t=0,1
\]
in particolare
\[
\Pi(0,X)=V^h(0)
\]

\paragraph{Pricing tramite sistema lineare}
Dato \(X=\phi(Z)\), il portafoglio replicante \(h=(x,y)\) risolve il sistema
\[
\begin{cases}
x(1+r)+ySu = \phi(u)\\
x(1+r)+ySd = \phi(d)
\end{cases}
\]
che ammette soluzione unica
\[
x=\frac{1}{1+r}\frac{u\phi(d)-d\phi(u)}{u-d},
\qquad
y=\frac{1}{S}\frac{\phi(u)-\phi(d)}{u-d}
\]

\paragraph{Risk-neutral pricing dei derivati}
Nel modello binomiale arbitrage-free, il prezzo di un contingent claim è
\[
\Pi(0,X)=\frac{1}{1+r}\mathbb{E}^Q[X]
\]
ossia il \textbf{valore atteso scontato del payoff sotto la misura risk-neutral}

\paragraph{Call option}
Una call europea con strike \(K\) ha payoff
\[
X=(S(1)-K)^+
\]
Il suo prezzo è
\[
C=\frac{1}{1+r}\Bigl(q_u(Su-K)^+ + q_d(Sd-K)^+\Bigr)
\]

\paragraph{Conclusioni}
\begin{itemize}[label=-]
\item Le probabilità oggettive determinano solo quali eventi sono possibili
\item I prezzi si calcolano come se il mondo fosse \textbf{risk-neutral}
\item La valutazione è indipendente dalle preferenze individuali
\item Il pricing è detto \textbf{preference-free valuation}
\item \textbf{Replicating portfolio} e \textbf{risk-neutral valuation} sono metodi equivalenti
\end{itemize}

\end{document}
